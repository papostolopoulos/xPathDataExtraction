var str1 = `1 $100 Mail-In Rebate includes Grabber™ X3, Grabber™ A/TX, Grabber™ APT, Grabber™ AT2.

2 $70 Mail-In Rebate includes Grabber™, Grabber™ HTS60, Grabber™ HD, G-MAX™ RS, G-MAX™ AS-05, G-MAX™ AS-03, Grabber™ UHP.

3 $50 Mail-In Rebate includes AltiMAX™ Arctic, AltiMAX™ Arctic12, AltiMAX™ HP, AltiMAX™ RT, AltiMAX™ RT43, Ameritrac™, Ameritrac™ TR, Grabber™ AW, Grabber™ HP, Grabber™ HTS, Grabber™ TR, GRABBER™ Arctic LT, GRABBER™ Arctic.

*See associate for complete offer details. Mail-in rebates are in the form of a Tire Pros Visa Prepaid Card. Offer valid only with qualified purchases made at participating Tire Pros locations in the forty-eight (48) contiguous continental U.S. and D.C. between November 1 and November 30, 2018.  Void where prohibited by law. No rain checks. Consumer receives up to $100 Prepaid Card for the purchase of four (4) new qualifying General Tire passenger or light truck tires. Consumer receives an additional $50 rebate on the Visa Prepaid Card when the qualifying General Tire purchase is made using a Tire Pros Credit Card (subject to credit approval). Valid with the original, dated, paid receipt from a participating Tire Pros retailer and a completed redemption form. Offer may not be combined with any other offer, discount, rebate, or promotion. Tires must be purchased in a single transaction. Offer not valid on purchases by wholesalers, dealers, fleets, OEM customers, or other commercial entities. Rebate form must be submitted online or postmarked by December 30, 2018. Please allow 6-8 weeks for delivery of your Visa Prepaid Card. If Visa Prepaid Card is not received, you must inquire no later than February 22, 2019 or all rights therein will expire. Requests from those with an invalid or undeliverable mailing address will be denied. Limit two (2) per household. Fraudulent submission and/or multiple requests could result in Federal prosecution under the U.S. Mail Fraud Statutes (18 USC. Section 1341 and 1342). The Visa Prepaid Cards are issued by MetaBank®, Member FDIC, pursuant to a license from Visa U.S.A. Inc. No cash access or recurring payments. Can be used everywhere Visa debit cards are accepted. Card valid for up to 6 months; unused funds will be forfeited at midnight EST the last day of the month of the valid thru date. Card terms and conditions apply, see MyPrepaidCenter.com/site/visa-promo.  MetaBank does not sponsor or endorse the optional Tire Credit Card.`;

var str2 = "Buy 3 t-shirts, get an extra one free";

var str3 = "Save 10% on sweaters. Valid from 10/22/2018 on 12:01am E.T. through 10/25/2018 on 11:59pm E.T.m May not be combined with other promotions.";

var str4 = "You will fall in love with these new offers | Get an extra $15 off on us on all sale items while you use your Fabulous card | Shop now!";

var str5 = "Dear Ethan, we missed you. As a welcome back gift, get a $5 coupon to use on any regular priced item. Offer expires in two days.";

var str6 = "• $1 = 15 points* • 2500 points = $10 reward • Buy 5 jeans, get one free**";

var str7 = `*Purchases subject to credit approval. Must use your AEO Connected, AEO or Aerie Visa Credit Card to earn points anywhere Visa credit cards are accepted. Earn 15 points per $1 spent at AEO® and Aerie® stores and ae.com and aerie.com after discounts, taxes and fees or earn 5 points per $1 spent outside AEO® and Aerie® stores and ae.com and aerie.com. Excludes gift cards. See AEO Connected Rewards Program Terms and Conditions for details at ae.com/aeoconnected/terms.

**Clearance jeans and bras are excluded from the five needed to earn this benefit.

***Free standard shipping to U.S., Puerto Rico and Canada.

Head off identity theft before it happens. For more information about identity theft, please visit the Federal Trade Commission's (FTC) consumer website.

This is an unmonitored email box. Please do not reply to this email.

NOTE: This email was sent by Synchrony Bank's AEO® Credit Services Division, the issuer of your AEO Connected Visa Credit Card account. Synchrony Bank is located at 170 Election Road, Suite 125, Draper, UT 84020-6425, USA. www.synchronyfinancial.com.

Unsubscribe: If you no longer wish to receive email marketing communications from Synchrony Bank's AEO® Credit Services Division, please click here to unsubscribe.

The AEO Connected, AEO and Aerie Visa Credit Cards are issued by Synchrony Bank pursuant to a license from Visa USA Inc.

© 2018 AEO Management Co. All rights reserved.`;

var str8 = "There is no place like home! Grab an opportunity to save. All towels and rugs start at $10.99. Hurry! Offer expires in two days.";

var str9 = "Save big on pillows. Was $29.99, now $15.99. It feels good to save!";

var str9a = "Save big on pillows. Was $29.99, now $15.99. It feels good to save! Plus, a special gift from us. While supplies last";

var str10 = "Big sale is on! Save 20% on everything! Plus, free shipping on all purchases that are $50 or more";

var str11 = "Earn 15 points per $1 spent at AEO® and Aerie® stores and ae.com and aerie.com after discounts, taxes and fees or earn 5 points per $1 spent outside AEO® and Aerie® stores and ae.com and aerie.com. Excludes gift cards. See AEO Connected Rewards Program Terms and Conditions for details at ae.com/aeoconnected/terms.";

var str12 = "30% off everything online or in stores. Use Code LANTERN. This special, limited purchase offer starts 8/24/2017 and expires 8/29/2017. Offers exclude custom-ordered products, Evertherm products, all sunglasses, tents, sleeping bags, First Ascent Packs and non-Eddie Bauer brand products. Offer at Eddie Bauer Outlet and Retail stores may vary, see store for details. Offer may not be valid in stores outside the United States. Offer does not include and cannot be applied to previous, pending or post-dated purchases, credit card balances, taxes, monogramming charges, gift cards, or gift boxes. Unless explicitly stated above, offers cannot be combined with any other offer. Offer details, including end date, are subject to change or cancellation without notice.";




//NEGATIVES - SHOULD RETURN NULL when the variable negRegexArr is populated with the related keywords.
var str13 = "Valid one time only on your purchase at U.S. And Canada Eddie Bauer stores, eddiebauer.com (if shipped to a U.S. Address), and through our catalogs. May not be exchanged for cash, used for credit card payments, or replaced if lost or stolen, except as required by law. May not be sold, auctioned, transferred, or combined with any other offer. VOID if altered or reproduced. Not valid on gift certificates/cards, or on prior or pending purchases. We reserve the right to cancel an order for unauthorized use. We may modify or cancel this promotion due to an error or unforeseen problems. Unused certificate amounts not payable in cash or subsequently redeemable. Cash value: 1/100 of a cent.";

var str14 = "(if shipped to a U.S. Address), and through our catalogs. May not be exchanged for cash, used for credit card payments, or replaced if lost or stolen, except as required by law. May not be sold, auctioned, transferred, or combined with any other offer. VOID if altered or reproduced. Not valid on gift certificates/cards, or on prior or pending purchases. We reserve the right to cancel an order for unauthorized use. We may modify or cancel this promotion due to an error or unforeseen problems. Unused certificate amounts not payable in cash or subsequently redeemable. Cash value: 1/100 of a cent.";

var str15 = "NO PURCHASE NECESSARY. Legal residents of the 50 United States (D.C.) & CA (excluding QC), 18 years or older. Enter Contest by 9/30/18. For Official Rules, including prize descriptions, visit www.eddiebauer.com/WhyIHike. 25 winners each month (prize valued at $100 USD/CAD) and 1 Grand Prize (valued at approximately $16,000 USD). Void where prohibited.";

var str16 = "* 30% offer valid at eddiebauer.com, at 800.426.8020, and Eddie Bauer stores, through 02/26/2012. Offer not valid on non-Eddie Bauer branded watches, sunglasses, gear, gadgets, tools, shoes, and accessories. Does not include and cannot be applied to previous or pending purchases, credit card balance, taxes, shipping or monogramming charges, gift cards or gift boxes. Offer cannot be combined with any other offer.";

var str17 = "*Eddie Bauer Credit Cards are issued by Comenity Bank. Subject to credit approval. Must open and use an Eddie Bauer Credit Card by 1/29 to receive $20 Reward Certificate.This reward is issued for promotional purposes. Certificate cannot be applied to prior purchases. Certificate cannot be used as payment on Eddie Bauer credit card accounts.";
















function transform(data){
  var negRegexArr = [
    //certificate can be used from
    /certificate\s*can\s*be\s*used\s*from/i,
    //Subject to credit approval
    /Subject\s*to\s*credit\s*approval/i,
    //$NN per month
    /\$\d+\s*per\s*month/i,
    //NN Points = $NN reward
    /^\d+\s*points\s*=\s*\$\d+\s*reward\s*$/i,
    //will appear within 90 days
    /will\s*appear\s*within\s*90\s*days/i,
    //Promotion restrictions
    /Promotion\s*restrictions/i,
    //Redeem your certificates now
    /Redeem\s*your\s*certificates\s*now/i,
    //The Account must remain open
    /The\s*Account\s*must\s*remain\s*open/i,
    //To redeem
    /^To\s*redeem/i,
    //You may have already redeemed your certificates
    /You\s*may\s*have\s*already\s*redeemed\s*your\s*certificates/i,
    //Look for your Rewards Certificates in the mai
    /Look\s*for\s*your\s*Rewards\s*Certificates\s*in\s*the\s*mail/i
  ];

  for (var i = 0; i < negRegexArr.length; i++) {
    if (negRegexArr[i].test(data)) return null;
  }


  var posRegexArr = [
    // (10% | $10 | percent) (off | (in )savings | discount | (cash)back | reward | gift | value | credit | (promotional )coupon | (mail-in )rebate | (e-)certificate | bonus | sale)
    /(\d{1,2}%|\$\d+(\.\d{2})?|percent)\s*(off|(in )?savings|discount|(cash(\s*)?)?back|reward|gift|value|credit|(promotional\s*)?coupon|(mail-in\s*)?rebate|(e-)?certificate|bonus|sale)/i,
    // (extra | up to | save | over | more than | discount of | discounted by | savings of | at least | gift of | down to | as low as | bonus of| get a) (10% | $10)
    /(extra|up\s*to|sav(e|ings\s*of)|over|more\s*than|discount(ed)?\s*(of|by)|at\s*least|gift\s*of|down\s*to|as\s*low\s*as|bonus\s*of|take|get(\s*a)?)\s*(\d{1,2}%|\$\d+(\.\d{2})?)/i,
    // was $10.99 | start at $10.99 sale $10.99
    /(sale:?|was:?|start\s*at)\s*\$\d+/i,
    //on sale | markdown | save on | marked down
    /on\s*sale|markdown|save\s*on|marked\s*down/i,
    //anniversary sale
    /anniversary\s*sale/i,
    // free ship | free on orders of | free $5 | free 10% | free delivery | free standard | free gift | free NN
    /free\s*(ship|on\s*orders\s*of|\$\d|\d+%|standard|delivery|gift|\d)/i,
    // buy one / two / three texttexttext, get
    /buy\s*(one|two|three|\d+),?.*\sget/i,
    //(standard | complementary | NN day) (shipping)
    /(standard|complimentary|\d+day)\s*shipping/i,
    //BOGO
    /BOGO/,
    // (100 | earn | get | gather | collect | your | redeem | reward) (points | rewards | gift | coupon | (e-)certificate)
    /(\d+|earn|get|gather|collect|your|redeem|reward)\s*(points|rewards?|gift|coupon|(e-)?certificate|a?\s*\$)/i,
    // (double | triple | NN times the) (points)
    /(double|triple|\d\s*times\s*the|\dx\s*the)\s*(points)/i,
    //promo(tion) code
    /promo(?:tion)\s*code\s*/i,
  ];

  for (var j = 0; j < posRegexArr.length; j++) {
    if (posRegexArr[j].test(data)) return data.length > 80 ? minimizeMe(data, posRegexArr[j]) : cleanMe(data);
  }

  return null;
}





function minimizeMe(str, reg){
  var punctuation = [". ", "! ", "| ", "? "]; //Punctuation symbols
  str = str.replace(/(\.)([A-z])/g, "$1 $2");

  //STAGE 1 - Slice text at the beginning of string
  var sliceStr = str.slice(0, str.indexOf(str.match(reg)[0])); //Create a substring from the beginning of string up to the beginning of the .match()
  var sliceStart = 0; //Define a variable where the slice at the beginning of the initial string will happen.


  //Iterate through the punctuation symbols.
  //If the last Index position of the punctuation is larger than the sliceStart variable,
  //then make the variable equal to the last index position.
  //That will be later used to slice the string at its beginning
  for (var i = 0; i < punctuation.length; i++) {
    if(sliceStr.lastIndexOf(punctuation[i]) > sliceStart) sliceStart = sliceStr.lastIndexOf(punctuation[i]);
  }
  //Slice the string from the beginning of the last punctuation mark but before the coupon description.
  if(sliceStart > 0) str = str.slice(sliceStart + 1).trim();




  //STAGE 2 - Slice text at the end of string
  var sliceEnd = +Infinity;
  //Iterate through the punctuation symbols.
  //If the punctuation symbol's index position is smaller than the sliceEnd variable, then
  //make the sliceEnd variable equal to the index position of the punctuation.
  //The sliceEnd will be used as the position where the slicing of the string will happen at it's end.
  for (var j = 0; j < punctuation.length; j++) {
    if (str.indexOf(punctuation[j]) < sliceEnd && str.indexOf(punctuation[j]) !== -1) sliceEnd = str.indexOf(punctuation[j]);
  }
  //Slice the end of the string
  str = str.slice(0, sliceEnd).trim();





  //STAGE 3 - Remove unecessary characters from the end of the string.
  return cleanMe(str);
}


function cleanMe(string) {
  var replaceStrArr = [
    {oldStr: /([A-z\.])\*([\$\sA-z])/, newStr: "$1 $2"},
    {oldStr: /(See\s*terms\.?(\s*Limited\s*time\s*offer\.)?|Offer\s*applies\s*to\s*select\s*items\s*only|Limited\s*Exclusions\s*Apply|or|Cannot\s*be\s*combined\s*with.*|Valid\s*in\s*store\s*only|YOUR\s*PURCHASE\s*VALID.*|(:\s*)?Subject\s*to\s*credit\s*approval)\s*$|\(\d\)|shop\s*now|Exclusions\s*apply.*/i, newStr: ""},
    {oldStr: /[\*©®ǂ‡†±+→§™¹›∞•◊ΔÐð®_]/g, newStr: ""},
    {oldStr: /^(To\s*redeem\s*Reward\s*Dollars\s*online\s*at\s*Belk|Plus|Through\s*[JFMASOND][aepuco][a-z]+\s*\d{1,2},?\s*\d{2,4},?|Reduced\s*delivery.*\.△|(Plus,?\s*\s*And\s*)?don't\s*forget,?|And|As\s*a\s*cardmember|Limited-?\s*time\s*(only|offer))/i, newStr: ""}
  ];

  for (var i = 0; i < replaceStrArr.length; i++) {
    if(replaceStrArr[i].oldStr.test(string)){
      string = string.replace(replaceStrArr[i].oldStr, replaceStrArr[i].newStr).trim();
      //break;
    }
  }


  // while("*©®ǂ‡†±+→§™¹›∞•◊ΔÐð_|".indexOf(string[string.length-1]) !== -1) string = string.slice(0, string.length-1);
  // while("*©®ǂ‡†±+→§™¹›∞•◊ΔÐð_".indexOf(string[0]) !== -1) string = string.slice(1);

  return string;
}
